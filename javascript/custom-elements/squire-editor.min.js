"use strict";(()=>{var Re=Object.create;var Dt=Object.defineProperty;var Ie=Object.getOwnPropertyDescriptor;var Pe=Object.getOwnPropertyNames;var Fe=Object.getPrototypeOf,Me=Object.prototype.hasOwnProperty;var He=(t=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(t,{get:(i,e)=>(typeof require<"u"?require:i)[e]}):t)(function(t){if(typeof require<"u")return require.apply(this,arguments);throw new Error('Dynamic require of "'+t+'" is not supported')});var Ue=(t,i,e,s)=>{if(i&&typeof i=="object"||typeof i=="function")for(let n of Pe(i))!Me.call(t,n)&&n!==e&&Dt(t,n,{get:()=>i[n],enumerable:!(s=Ie(i,n))||s.enumerable});return t};var ze=(t,i,e)=>(e=t!=null?Re(Fe(t)):{},Ue(i||!t||!t.__esModule?Dt(e,"default",{value:t,enumerable:!0}):e,t));var zt=1,j=4,K=5,qe=()=>!0,A=class{root;currentNode;nodeType;filter;constructor(t,i,e){this.root=t,this.currentNode=t,this.nodeType=i,this.filter=e||qe}isAcceptableNode(t){let i=t.nodeType;return!!((i===Node.ELEMENT_NODE?zt:i===Node.TEXT_NODE?j:0)&this.nodeType)&&this.filter(t)}nextNode(){let t=this.root,i=this.currentNode,e;for(;;){for(e=i.firstChild;!e&&i&&i!==t;)e=i.nextSibling,e||(i=i.parentNode);if(!e)return null;if(this.isAcceptableNode(e))return this.currentNode=e,e;i=e}}previousNode(){let t=this.root,i=this.currentNode,e;for(;;){if(i===t)return null;if(e=i.previousSibling,e)for(;i=e.lastChild;)e=i;else e=i.parentNode;if(!e)return null;if(this.isAcceptableNode(e))return this.currentNode=e,e;i=e}}previousPONode(){let t=this.root,i=this.currentNode,e;for(;;){for(e=i.lastChild;!e&&i&&i!==t;)e=i.previousSibling,e||(i=i.parentNode);if(!e)return null;if(this.isAcceptableNode(e))return this.currentNode=e,e;i=e}}},Ve=1,qt=3,We=11,Y="\u200B",Z=navigator.userAgent,gt=/Mac OS X/.test(Z),Vt=/Windows NT/.test(Z),Wt=/iP(?:ad|hone|od)/.test(Z)||gt&&!!navigator.maxTouchPoints,Ke=/Android/.test(Z),$e=/Gecko\//.test(Z),rt=/Edge\//.test(Z),Ze=!rt&&/WebKit\//.test(Z),k=gt||Wt?"Meta-":"Ctrl-",ut=Ze,Ge="onbeforeinput"in document&&"inputType"in new InputEvent("input"),I=/[^ \t\r\n]/,Qe=/^(?:#text|A(?:BBR|CRONYM)?|B(?:R|D[IO])?|C(?:ITE|ODE)|D(?:ATA|EL|FN)|EM|FONT|HR|I(?:FRAME|MG|NPUT|NS)?|KBD|Q|R(?:P|T|UBY)|S(?:AMP|MALL|PAN|TR(?:IKE|ONG)|U[BP])?|TIME|U|VAR|WBR)$/,je=new Set(["BR","HR","IFRAME","IMG","INPUT"]),Ye=0,pt=1,Kt=2,$t=3,ot=new WeakMap,Je=()=>{ot=new WeakMap},q=t=>je.has(t.nodeName),Nt=t=>{switch(t.nodeType){case qt:return pt;case Ve:case We:if(ot.has(t))return ot.get(t);break;default:return Ye}let i;return Array.from(t.childNodes).every(v)?Qe.test(t.nodeName)?i=pt:i=Kt:i=$t,ot.set(t,i),i},v=t=>Nt(t)===pt,U=t=>Nt(t)===Kt,J=t=>Nt(t)===$t,m=(t,i,e)=>{let s=document.createElement(t);if(i instanceof Array&&(e=i,i=null),i)for(let n in i){let o=i[n];o!==void 0&&s.setAttribute(n,o)}return e&&e.forEach(n=>s.appendChild(n)),s},Zt=(t,i)=>q(t)||t.nodeType!==i.nodeType||t.nodeName!==i.nodeName?!1:t instanceof HTMLElement&&i instanceof HTMLElement?t.nodeName!=="A"&&t.className===i.className&&t.style.cssText===i.style.cssText:!0,mt=(t,i,e)=>{if(t.nodeName!==i)return!1;for(let s in e)if(!("getAttribute"in t)||t.getAttribute(s)!==e[s])return!1;return!0},S=(t,i,e,s)=>{for(;t&&t!==i;){if(mt(t,e,s))return t;t=t.parentNode}return null},_t=(t,i)=>{let e=t.childNodes;for(;i&&t instanceof Element;)t=e[i-1],e=t.childNodes,i=e.length;return t},Gt=(t,i)=>{let e=t;if(e instanceof Element){let s=e.childNodes;if(i<s.length)e=s[i];else{for(;e&&!e.nextSibling;)e=e.parentNode;e&&(e=e.nextSibling)}}return e},O=t=>t instanceof Element||t instanceof DocumentFragment?t.childNodes.length:t instanceof CharacterData?t.length:0,g=t=>{let i=document.createDocumentFragment(),e=t.firstChild;for(;e;)i.appendChild(e),e=t.firstChild;return i},b=t=>{let i=t.parentNode;return i&&i.removeChild(t),t},w=(t,i)=>{let e=t.parentNode;e&&e.replaceChild(i,t)},Xe=t=>t instanceof Element?t.nodeName==="BR":I.test(t.data),ct=(t,i)=>{let e=t.parentNode;for(;v(e);)e=e.parentNode;let s=new A(e,K,Xe);return s.currentNode=t,!!s.nextNode()||i&&!s.previousNode()},ht=(t,i)=>{let e=new A(t,j),s,n;for(;s=e.nextNode();)for(;(n=s.data.indexOf(Y))>-1&&(!i||s.parentNode!==i);)if(s.length===1){let o=s,r=o.parentNode;for(;r&&(r.removeChild(o),e.currentNode=r,!(!v(r)||O(r)));)o=r,r=o.parentNode;break}else s.deleteData(n,1)},ti=0,ei=1,ii=2,si=3,H=(t,i,e)=>{let s=document.createRange();if(s.selectNode(i),e){let n=t.compareBoundaryPoints(si,s)>-1,o=t.compareBoundaryPoints(ei,s)<1;return!n&&!o}else{let n=t.compareBoundaryPoints(ti,s)<1,o=t.compareBoundaryPoints(ii,s)>-1;return n&&o}},T=t=>{let{startContainer:i,startOffset:e,endContainer:s,endOffset:n}=t;for(;!(i instanceof Text);){let o=i.childNodes[e];if(!o||q(o)){if(e&&(o=i.childNodes[e-1],o instanceof Text)){let r=o,a;for(;!r.length&&(a=r.previousSibling)&&a instanceof Text;)r.remove(),r=a;i=r,e=r.data.length}break}i=o,e=0}if(n)for(;!(s instanceof Text);){let o=s.childNodes[n-1];if(!o||q(o)){if(o&&o.nodeName==="BR"&&!ct(o,!1)){n-=1;continue}break}s=o,n=O(s)}else for(;!(s instanceof Text);){let o=s.firstChild;if(!o||q(o))break;s=o}t.setStart(i,e),t.setEnd(s,n)},V=(t,i,e,s)=>{let n=t.startContainer,o=t.startOffset,r=t.endContainer,a=t.endOffset,l;for(i||(i=t.commonAncestorContainer),e||(e=i);!o&&n!==i&&n!==s;)l=n.parentNode,o=Array.from(l.childNodes).indexOf(n),n=l;for(;!(r===e||r===s||(r.nodeType!==qt&&r.childNodes[a]&&r.childNodes[a].nodeName==="BR"&&!ct(r.childNodes[a],!1)&&(a+=1),a!==O(r)));)l=r.parentNode,a=Array.from(l.childNodes).indexOf(r)+1,r=l;t.setStart(n,o),t.setEnd(r,a)},Rt=(t,i,e)=>{let s=S(t.endContainer,e,i);if(s&&(s=s.parentNode)){let n=t.cloneRange();V(n,s,s,e),n.endContainer===s&&(t.setStart(n.endContainer,n.endOffset),t.setEnd(n.endContainer,n.endOffset))}return t},_=t=>{let i=null;if(t instanceof Text)return t;if(v(t)){let e=t.firstChild;if(ut)for(;e&&e instanceof Text&&!e.data;)t.removeChild(e),e=t.firstChild;e||(ut?i=document.createTextNode(Y):i=document.createTextNode(""))}else if(t instanceof Element&&!t.querySelector("BR")){i=m("BR");let e=t,s;for(;(s=e.lastElementChild)&&!v(s);)e=s}if(i)try{t.appendChild(i)}catch{}return t},D=(t,i)=>{let e=null;return Array.from(t.childNodes).forEach(s=>{let n=s.nodeName==="BR";!n&&v(s)?(e||(e=m("DIV")),e.appendChild(s)):(n||e)&&(e||(e=m("DIV")),_(e),n?t.replaceChild(e,s):t.insertBefore(e,s),e=null),J(s)&&D(s,i)}),e&&t.appendChild(_(e)),t},y=(t,i,e,s)=>{if(t instanceof Text&&t!==e){if(typeof i!="number")throw new Error("Offset must be a number to split text node!");if(!t.parentNode)throw new Error("Cannot split text node with no parent!");return y(t.parentNode,t.splitText(i),e,s)}let n=typeof i=="number"?i<t.childNodes.length?t.childNodes[i]:null:i,o=t.parentNode;if(!o||t===e||!(t instanceof Element))return n;let r=t.cloneNode(!1);for(;n;){let a=n.nextSibling;r.appendChild(n),n=a}return t instanceof HTMLOListElement&&S(t,s,"BLOCKQUOTE")&&(r.start=(+t.start||1)+t.childNodes.length-1),_(t),_(r),o.insertBefore(r,t.nextSibling),y(o,r,e,s)},Qt=(t,i)=>{let e=t.childNodes,s=e.length,n=[];for(;s--;){let o=e[s],r=s?e[s-1]:null;if(r&&v(o)&&Zt(o,r))i.startContainer===o&&(i.startContainer=r,i.startOffset+=O(r)),i.endContainer===o&&(i.endContainer=r,i.endOffset+=O(r)),i.startContainer===t&&(i.startOffset>s?i.startOffset-=1:i.startOffset===s&&(i.startContainer=r,i.startOffset=O(r))),i.endContainer===t&&(i.endOffset>s?i.endOffset-=1:i.endOffset===s&&(i.endContainer=r,i.endOffset=O(r))),b(o),o instanceof Text?r.appendData(o.data):n.push(g(o));else if(o instanceof Element){let a;for(;a=n.pop();)o.appendChild(a);Qt(o,i)}}},Q=(t,i)=>{let e=t instanceof Text?t.parentNode:t;if(e instanceof Element){let s={startContainer:i.startContainer,startOffset:i.startOffset,endContainer:i.endContainer,endOffset:i.endOffset};Qt(e,s),i.setStart(s.startContainer,s.startOffset),i.setEnd(s.endContainer,s.endOffset)}},it=(t,i,e,s)=>{let n=i,o,r;for(;(o=n.parentNode)&&o!==s&&o instanceof Element&&o.childNodes.length===1;)n=o;b(n),r=t.childNodes.length;let a=t.lastChild;a&&a.nodeName==="BR"&&(t.removeChild(a),r-=1),t.appendChild(g(i)),e.setStart(t,r),e.collapse(!0),Q(t,e)},P=(t,i)=>{let e=t.previousSibling,s=t.firstChild,n=t.nodeName==="LI";if(!(n&&(!s||!/^[OU]L$/.test(s.nodeName)))){if(e&&Zt(e,t)){if(!J(e))if(n){let r=m("DIV");r.appendChild(g(e)),e.appendChild(r)}else return;b(t);let o=!J(t);e.appendChild(g(t)),o&&D(e,i),s&&P(s,i)}else if(n){let o=m("DIV");t.insertBefore(o,s),_(o)}}},It={"font-weight":{regexp:/^bold|^700/i,replace(){return m("B")}},"font-style":{regexp:/^italic/i,replace(){return m("I")}},"font-family":{regexp:I,replace(t,i){return m("SPAN",{class:t.fontFamily,style:"font-family:"+i})}},"font-size":{regexp:I,replace(t,i){return m("SPAN",{class:t.fontSize,style:"font-size:"+i})}},"text-decoration":{regexp:/^underline/i,replace(){return m("U")}}},ni=(t,i,e)=>{let s=t.style,n,o;for(let r in It){let a=It[r],l=s.getPropertyValue(r);if(l&&a.regexp.test(l)){let c=a.replace(e.classNames,l);if(c.nodeName===t.nodeName&&c.className===t.className)continue;o||(o=c),n&&n.appendChild(c),n=c,t.style.removeProperty(r)}}return o&&n&&(n.appendChild(g(t)),t.style.cssText?t.appendChild(o):w(t,o)),n||t},nt=t=>(i,e)=>{let s=m(t),n=i.attributes;for(let o=0,r=n.length;o<r;o+=1){let a=n[o];s.setAttribute(a.name,a.value)}return e.replaceChild(s,i),s.appendChild(g(i)),s},oi={1:"10",2:"13",3:"16",4:"18",5:"24",6:"32",7:"48"},ri={STRONG:nt("B"),EM:nt("I"),INS:nt("U"),STRIKE:nt("S"),SPAN:ni,FONT:(t,i,e)=>{let s=t,n=s.face,o=s.size,r=s.color,a=e.classNames,l,c,d,h,f;return n&&(l=m("SPAN",{class:a.fontFamily,style:"font-family:"+n}),f=l,h=l),o&&(c=m("SPAN",{class:a.fontSize,style:"font-size:"+oi[o]+"px"}),f||(f=c),h&&h.appendChild(c),h=c),r&&/^#?([\dA-F]{3}){1,2}$/i.test(r)&&(r.charAt(0)!=="#"&&(r="#"+r),d=m("SPAN",{class:a.color,style:"color:"+r}),f||(f=d),h&&h.appendChild(d),h=d),(!f||!h)&&(f=h=m("SPAN")),i.replaceChild(f,s),h.appendChild(g(s)),h},TT:(t,i,e)=>{let s=m("SPAN",{class:e.classNames.fontFamily,style:'font-family:menlo,consolas,"courier new",monospace'});return i.replaceChild(s,t),s.appendChild(g(t)),s}},ai=/^(?:A(?:DDRESS|RTICLE|SIDE|UDIO)|BLOCKQUOTE|CAPTION|D(?:[DLT]|IV)|F(?:IGURE|IGCAPTION|OOTER)|H[1-6]|HEADER|L(?:ABEL|EGEND|I)|O(?:L|UTPUT)|P(?:RE)?|SECTION|T(?:ABLE|BODY|D|FOOT|H|HEAD|R)|COL(?:GROUP)?|UL)$/,li=/^(?:HEAD|META|STYLE)/,vt=(t,i,e)=>{let s=t.childNodes,n=t;for(;v(n);)n=n.parentNode;let o=new A(n,K);for(let r=0,a=s.length;r<a;r+=1){let l=s[r],c=l.nodeName,d=ri[c];if(l instanceof HTMLElement){let h=l.childNodes.length;if(d)l=d(l,t,i);else if(li.test(c)){t.removeChild(l),r-=1,a-=1;continue}else if(!ai.test(c)&&!v(l)){r-=1,a+=h-1,t.replaceChild(g(l),l);continue}h&&vt(l,i,e||c==="PRE")}else{if(l instanceof Text){let h=l.data,f=!I.test(h.charAt(0)),u=!I.test(h.charAt(h.length-1));if(e||!f&&!u)continue;if(f){o.currentNode=l;let p;for(;(p=o.previousPONode())&&!(p.nodeName==="IMG"||p instanceof Text&&I.test(p.data));)if(!v(p)){p=null;break}h=h.replace(/^[ \t\r\n]+/g,p?" ":"")}if(u){o.currentNode=l;let p;for(;(p=o.nextNode())&&!(p.nodeName==="IMG"||p instanceof Text&&I.test(p.data));)if(!v(p)){p=null;break}h=h.replace(/[ \t\r\n]+$/g,p?" ":"")}if(h){l.data=h;continue}}t.removeChild(l),r-=1,a-=1}}return t},Ct=t=>{let i=t.childNodes,e=i.length;for(;e--;){let s=i[e];s instanceof Element&&!q(s)?(Ct(s),v(s)&&!s.firstChild&&t.removeChild(s)):s instanceof Text&&!s.data&&t.removeChild(s)}},at=(t,i,e)=>{let s=t.querySelectorAll("BR"),n=[],o=s.length;for(let r=0;r<o;r+=1)n[r]=ct(s[r],e);for(;o--;){let r=s[o],a=r.parentNode;a&&(n[o]?v(a)||D(a,i):b(r))}},Pt=t=>t.split("&").join("&amp;").split("<").join("&lt;").split(">").join("&gt;").split('"').join("&quot;"),lt=(t,i)=>{let e=new A(i,zt,U);return e.currentNode=t,e},X=(t,i)=>{let e=lt(t,i).previousNode();return e!==i?e:null},z=(t,i)=>{let e=lt(t,i).nextNode();return e!==i?e:null},St=t=>!t.textContent&&!t.querySelector("IMG"),B=(t,i)=>{let e=t.startContainer,s;if(v(e))s=X(e,i);else if(e!==i&&e instanceof HTMLElement&&U(e))s=e;else{let n=_t(e,t.startOffset);s=z(n,i)}return s&&H(t,s,!0)?s:null},$=(t,i)=>{let e=t.endContainer,s;if(v(e))s=X(e,i);else if(e!==i&&e instanceof HTMLElement&&U(e))s=e;else{let n=Gt(e,t.endOffset);if(!n||!i.contains(n)){n=i;let o;for(;o=n.lastChild;)n=o}s=X(n,i)}return s&&H(t,s,!0)?s:null},jt=t=>t instanceof Text?I.test(t.data):t.nodeName==="IMG",st=(t,i)=>{let e=t.startContainer,s=t.startOffset,n;if(e instanceof Text){if(s)return!1;n=e}else if(n=Gt(e,s),n&&!i.contains(n)&&(n=null),!n&&(n=_t(e,s),n instanceof Text&&n.length))return!1;let o=B(t,i);if(!o)return!1;let r=new A(o,K,jt);return r.currentNode=n,!r.previousNode()},dt=(t,i)=>{let e=t.endContainer,s=t.endOffset,n;if(e instanceof Text){let a=e.data.length;if(a&&s<a)return!1;n=e}else n=_t(e,s);let o=$(t,i);if(!o)return!1;let r=new A(o,K,jt);return r.currentNode=n,!r.nextNode()},Ft=(t,i)=>{let e=B(t,i),s=$(t,i),n;e&&s&&(n=e.parentNode,t.setStart(n,Array.from(n.childNodes).indexOf(e)),n=s.parentNode,t.setEnd(n,Array.from(n.childNodes).indexOf(s)+1))};function W(t,i,e,s){let n=document.createRange();return n.setStart(t,i),e&&typeof s=="number"?n.setEnd(e,s):n.setEnd(t,i),n}var R=(t,i)=>{let{startContainer:e,startOffset:s,endContainer:n,endOffset:o}=t,r;if(e instanceof Text){let l=e.parentNode;if(r=l.childNodes,s===e.length)s=Array.from(r).indexOf(e)+1,t.collapsed&&(n=l,o=s);else{if(s){let c=e.splitText(s);n===e?(o-=s,n=c):n===l&&(o+=1),e=c}s=Array.from(r).indexOf(e)}e=l}else r=e.childNodes;let a=r.length;s===a?e.appendChild(i):e.insertBefore(i,r[s]),e===n&&(o+=r.length-a),t.setStart(e,s),t.setEnd(n,o)},Yt=(t,i,e)=>{let s=document.createDocumentFragment();if(t.collapsed)return s;i||(i=t.commonAncestorContainer),i instanceof Text&&(i=i.parentNode);let n=t.startContainer,o=t.startOffset,r=y(t.endContainer,t.endOffset,i,e),a=0,l=y(n,o,i,e);for(;l&&l!==r;){let c=l.nextSibling;s.appendChild(l),l=c}return n instanceof Text&&r instanceof Text&&(n.appendData(r.data),b(r),r=n,a=o),t.setStart(n,o),r?t.setEnd(r,a):t.setEnd(i,i.childNodes.length),_(i),s},Mt=(t,i,e)=>{t.currentNode=e;let s;for(;s=t[i]();){if(s instanceof Text||q(s))return s;if(!v(s))return null}return null},G=(t,i)=>{let e=B(t,i),s=$(t,i),n=e!==s;e&&s&&(T(t),V(t,e,s,i));let o=Yt(t,null,i);T(t),n&&(s=$(t,i),e&&s&&e!==s&&it(e,s,t,i)),e&&_(e);let r=i.firstChild;(!r||r.nodeName==="BR")&&(_(i),i.firstChild&&t.selectNodeContents(i.firstChild)),t.collapse(!0);let a=t.startContainer,l=t.startOffset,c=new A(i,K),d=a,h=l;(!(d instanceof Text)||h===d.data.length)&&(d=Mt(c,"nextNode",d),h=0);let f=a,u=l-1;(!(f instanceof Text)||u===-1)&&(f=Mt(c,"previousPONode",d||(a instanceof Text?a:a.childNodes[l]||a)),f instanceof Text&&(u=f.data.length));let p=null,C=0;return d instanceof Text&&d.data.charAt(h)===" "&&st(t,i)?(p=d,C=h):f instanceof Text&&f.data.charAt(u)===" "&&(d instanceof Text&&d.data.charAt(h)===" "||dt(t,i))&&(p=f,C=u),p&&p.replaceData(C,1,"\xA0"),t.setStart(a,l),t.collapse(!0),o},ci=(t,i,e)=>{let s=i.firstChild&&v(i.firstChild),n;for(D(i,e),n=i;n=z(n,e);)_(n);t.collapsed||G(t,e),T(t),t.collapse(!1);let o=S(t.endContainer,e,"BLOCKQUOTE")||e,r=B(t,e),a=null,l=z(i,i),c=!s&&!!r&&St(r);if(r&&l&&!c&&!S(l,i,"PRE")&&!S(l,i,"TABLE")){V(t,r,r,e),t.collapse(!0);let d=t.endContainer,h=t.endOffset;if(at(r,e,!1),v(d)){let f=y(d,h,X(d,e)||e,e);d=f.parentNode,h=Array.from(d.childNodes).indexOf(f)}if(h!==O(d))for(a=document.createDocumentFragment();n=d.childNodes[h];)a.appendChild(n);it(d,l,t,e),h=Array.from(d.parentNode.childNodes).indexOf(d)+1,d=d.parentNode,t.setEnd(d,h)}if(O(i)){c&&r&&(t.setEndBefore(r),t.collapse(!1),b(r)),V(t,o,o,e);let d=y(t.endContainer,t.endOffset,o,e),h=d?d.previousSibling:o.lastChild;o.insertBefore(i,d),d?t.setEndBefore(d):t.setEnd(o,O(o)),r=$(t,e),T(t);let f=t.endContainer,u=t.endOffset;d&&J(d)&&P(d,e),d=h&&h.nextSibling,d&&J(d)&&P(d,e),t.setEnd(f,u)}if(a&&r){let d=t.cloneRange();it(r,a,d,e),t.setEnd(d.endContainer,d.endOffset)}T(t)},ft=Array.prototype.indexOf,di=(t,i,e,s,n,o)=>{let r=t.clipboardData,a=document.body,l=m("DIV"),c,d;i.childNodes.length===1&&i.childNodes[0]instanceof Text?(d=i.childNodes[0].data.replace(/ /g," "),o=!0):(l.appendChild(i),c=l.innerHTML,s&&(c=s(c))),d!==void 0||(n&&c!==void 0?d=n(c):(at(l,e,!0),l.setAttribute("style","position:fixed;overflow:hidden;bottom:100%;right:100%;"),a.appendChild(l),d=l.innerText||l.textContent,d=d.replace(/ /g," "),a.removeChild(l))),Vt&&(d=d.replace(/\r?\n/g,`\r
`)),!o&&c&&d!==c&&r.setData("text/html",c),r.setData("text/plain",d),t.preventDefault()},Jt=(t,i,e,s,n,o,r)=>{if(!rt&&t.clipboardData){let a=B(i,e),l=$(i,e),c=e;a===l&&a?.contains(i.commonAncestorContainer)&&(c=a);let d;s?d=G(i,e):(i=i.cloneRange(),T(i),V(i,c,c,e),d=i.cloneContents());let h=i.commonAncestorContainer;for(h instanceof Text&&(h=h.parentNode);h&&h!==c;){let f=h.cloneNode(!1);f.appendChild(d),d=f,h=h.parentNode}return di(t,d,e,n,o,r),!0}return!1},hi=function(t){let i=this.getSelection(),e=this._root;if(i.collapsed){t.preventDefault();return}this.saveUndoState(i),Jt(t,i,e,!0,this._config.willCutCopy,null,!1)||setTimeout(()=>{try{this._ensureBottomLine()}catch(n){this._config.didError(n)}},0),this.setSelection(i)},fi=function(t){Jt(t,this.getSelection(),this._root,!1,this._config.willCutCopy,null,!1)},Ht=function(t){this._isShiftDown=t.shiftKey},ui=function(t){let i=t.clipboardData,e=i?.items,s=this._isShiftDown,n=!1,o=!1,r=null,a=null;if(e){let x=e.length;for(;x--;){let E=e[x],L=E.type;L==="text/html"?a=E:L==="text/plain"||L==="text/uri-list"?r=E:L==="text/rtf"?n=!0:/^image\/.*/.test(L)&&(o=!0)}if(o&&!(n&&a)){t.preventDefault(),this.fireEvent("pasteImage",{clipboardData:i});return}if(!rt){t.preventDefault(),a&&(!s||!r)?a.getAsString(E=>{this.insertHTML(E,!0)}):r&&r.getAsString(E=>{let L=!1,Ot=this.getSelection();if(!Ot.collapsed&&I.test(Ot.toString())){let Bt=this.linkRegExp.exec(E);L=!!Bt&&Bt[0].length===E.length}L?this.makeLink(E):this.insertPlainText(E,!0)});return}}let l=i?.types;if(!rt&&l&&(ft.call(l,"text/html")>-1||!$e&&ft.call(l,"text/plain")>-1&&ft.call(l,"text/rtf")<0)){t.preventDefault();let x;!s&&(x=i.getData("text/html"))?this.insertHTML(x,!0):((x=i.getData("text/plain"))||(x=i.getData("text/uri-list")))&&this.insertPlainText(x,!0);return}let c=document.body,d=this.getSelection(),h=d.startContainer,f=d.startOffset,u=d.endContainer,p=d.endOffset,C=m("DIV",{contenteditable:"true",style:"position:fixed; overflow:hidden; top:0; right:100%; width:1px; height:1px;"});c.appendChild(C),d.selectNodeContents(C),this.setSelection(d),setTimeout(()=>{try{let x="",E=C,L;for(;C=E;)E=C.nextSibling,b(C),L=C.firstChild,L&&L===C.lastChild&&L instanceof HTMLDivElement&&(C=L),x+=C.innerHTML;this.setSelection(W(h,f,u,p)),x&&this.insertHTML(x,!0)}catch(x){this._config.didError(x)}},0)},pi=function(t){if(!t.dataTransfer)return;let i=t.dataTransfer.types,e=i.length,s=!1,n=!1;for(;e--;)switch(i[e]){case"text/plain":s=!0;break;case"text/html":n=!0;break;default:return}(n||s&&this.saveUndoState)&&this.saveUndoState()},Ut=(t,i,e)=>{i.preventDefault(),t.splitBlock(i.shiftKey,e)},et=(t,i)=>{try{i||(i=t.getSelection());let e=i.startContainer;e instanceof Text&&(e=e.parentNode);let s=e;for(;v(s)&&(!s.textContent||s.textContent===Y);)e=s,s=e.parentNode;e!==s&&(i.setStart(s,Array.from(s.childNodes).indexOf(e)),i.collapse(!0),s.removeChild(e),U(s)||(s=X(s,t._root)||t._root),_(s),T(i)),e===t._root&&(e=e.firstChild)&&e.nodeName==="BR"&&b(e),t._ensureBottomLine(),t.setSelection(i),t._updatePath(i,!0)}catch(e){t._config.didError(e)}},Xt=(t,i)=>{let e;for(;(e=t.parentNode)&&!(e===i||e.isContentEditable);)t=e;b(t)},te=(t,i,e)=>{if(S(i,t._root,"A"))return;let s=i.data||"",n=Math.max(s.lastIndexOf(" ",e-1),s.lastIndexOf("\xA0",e-1))+1,o=s.slice(n,e),r=t.linkRegExp.exec(o);if(r){let a=t.getSelection();t._docWasChanged(),t._recordUndoState(a),t._getRangeAndRemoveBookmark(a);let l=n+r.index,c=l+r[0].length,d=a.startContainer===i,h=a.startOffset-c;l&&(i=i.splitText(l));let f=t._config.tagAttributes.a,u=m("A",Object.assign({href:r[1]?/^(?:ht|f)tps?:/i.test(r[1])?r[1]:"http://"+r[1]:"mailto:"+r[0]},f));u.textContent=s.slice(l,c),i.parentNode.insertBefore(u,i),i.data=s.slice(c),d&&(a.setStart(i,h),a.setEnd(i,h)),t.setSelection(a)}},mi=(t,i,e)=>{let s=t._root;if(t._removeZWS(),t.saveUndoState(e),!e.collapsed)i.preventDefault(),G(e,s),et(t,e);else if(st(e,s)){i.preventDefault();let n=B(e,s);if(!n)return;let o=n;D(o.parentNode,s);let r=X(o,s);if(r){if(!r.isContentEditable){Xt(r,s);return}for(it(r,o,e,s),o=r.parentNode;o!==s&&!o.nextSibling;)o=o.parentNode;o!==s&&(o=o.nextSibling)&&P(o,s),t.setSelection(e)}else if(o){if(S(o,s,"UL")||S(o,s,"OL")){t.decreaseListLevel(e);return}else if(S(o,s,"BLOCKQUOTE")){t.removeQuote(e);return}t.setSelection(e),t._updatePath(e,!0)}}else{T(e);let n=e.startContainer,o=e.startOffset,r=n.parentNode;n instanceof Text&&r instanceof HTMLAnchorElement&&o&&r.href.includes(n.data)?(n.deleteData(o-1,1),t.setSelection(e),t.removeLink(),i.preventDefault()):(t.setSelection(e),setTimeout(()=>{et(t)},0))}},vi=(t,i,e)=>{let s=t._root,n,o,r,a,l,c;if(t._removeZWS(),t.saveUndoState(e),!e.collapsed)i.preventDefault(),G(e,s),et(t,e);else if(dt(e,s)){if(i.preventDefault(),n=B(e,s),!n)return;if(D(n.parentNode,s),o=z(n,s),o){if(!o.isContentEditable){Xt(o,s);return}for(it(n,o,e,s),o=n.parentNode;o!==s&&!o.nextSibling;)o=o.parentNode;o!==s&&(o=o.nextSibling)&&P(o,s),t.setSelection(e),t._updatePath(e,!0)}}else{if(r=e.cloneRange(),V(e,s,s,s),a=e.endContainer,l=e.endOffset,a instanceof Element&&(c=a.childNodes[l],c&&c.nodeName==="IMG")){i.preventDefault(),b(c),T(e),et(t,e);return}t.setSelection(r),setTimeout(()=>{et(t)},0)}},Ci=(t,i,e)=>{let s=t._root;if(t._removeZWS(),e.collapsed&&st(e,s)){let n=B(e,s),o;for(;o=n.parentNode;){if(o.nodeName==="UL"||o.nodeName==="OL"){i.preventDefault(),t.increaseListLevel(e);break}n=o}}},Si=(t,i,e)=>{let s=t._root;if(t._removeZWS(),e.collapsed&&st(e,s)){let n=e.startContainer;(S(n,s,"UL")||S(n,s,"OL"))&&(i.preventDefault(),t.decreaseListLevel(e))}},gi=(t,i,e)=>{let s,n=t._root;if(t._recordUndoState(e),t._getRangeAndRemoveBookmark(e),e.collapsed||(G(e,n),t._ensureBottomLine(),t.setSelection(e),t._updatePath(e,!0)),s=e.endContainer,e.endOffset===O(s))do if(s.nodeName==="A"){e.setStartAfter(s);break}while(!s.nextSibling&&(s=s.parentNode)&&s!==n);if(t._config.addLinks){let o=e.cloneRange();T(o);let r=o.startContainer,a=o.startOffset;setTimeout(()=>{te(t,r,a)},0)}t.setSelection(e)},Ni={8:"Backspace",9:"Tab",13:"Enter",27:"Escape",32:"Space",33:"PageUp",34:"PageDown",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",46:"Delete",191:"/",219:"[",220:"\\",221:"]"},_i=function(t){let i=t.keyCode,e=Ni[i],s="",n=this.getSelection();t.defaultPrevented||(e||(e=String.fromCharCode(i).toLowerCase(),/^[A-Za-z0-9]$/.test(e)||(e="")),111<i&&i<124&&(e="F"+(i-111)),e!=="Backspace"&&e!=="Delete"&&(t.altKey&&(s+="Alt-"),t.ctrlKey&&(s+="Ctrl-"),t.metaKey&&(s+="Meta-"),t.shiftKey&&(s+="Shift-")),Vt&&t.shiftKey&&e==="Delete"&&(s+="Shift-"),e=s+e,this._keyHandlers[e]?this._keyHandlers[e](this,t,n):!n.collapsed&&!t.isComposing&&!t.ctrlKey&&!t.metaKey&&(t.key||e).length===1&&(this.saveUndoState(n),G(n,this._root),this._ensureBottomLine(),this.setSelection(n),this._updatePath(n,!0)))},N={Backspace:mi,Delete:vi,Tab:Ci,"Shift-Tab":Si,Space:gi,ArrowLeft(t){t._removeZWS()},ArrowRight(t,i,e){t._removeZWS();let s=t.getRoot();if(dt(e,s)){T(e);let n=e.endContainer;do if(n.nodeName==="CODE"){let o=n.nextSibling;if(!(o instanceof Text)){let r=document.createTextNode("\xA0");n.parentNode.insertBefore(r,o),o=r}e.setStart(o,1),t.setSelection(e),i.preventDefault();break}while(!n.nextSibling&&(n=n.parentNode)&&n!==s)}}};Ge||(N.Enter=Ut,N["Shift-Enter"]=Ut);!gt&&!Wt&&(N.PageUp=t=>{t.moveCursorToStart()},N.PageDown=t=>{t.moveCursorToEnd()});var tt=(t,i)=>(i=i||null,(e,s)=>{s.preventDefault();let n=e.getSelection();e.hasFormat(t,null,n)?e.changeFormat(null,{tag:t},n):e.changeFormat({tag:t},i,n)});N[k+"b"]=tt("B");N[k+"i"]=tt("I");N[k+"u"]=tt("U");N[k+"Shift-7"]=tt("S");N[k+"Shift-5"]=tt("SUB",{tag:"SUP"});N[k+"Shift-6"]=tt("SUP",{tag:"SUB"});N[k+"Shift-8"]=(t,i)=>{i.preventDefault();let e=t.getPath();/(?:^|>)UL/.test(e)?t.removeList():t.makeUnorderedList()};N[k+"Shift-9"]=(t,i)=>{i.preventDefault();let e=t.getPath();/(?:^|>)OL/.test(e)?t.removeList():t.makeOrderedList()};N[k+"["]=(t,i)=>{i.preventDefault();let e=t.getPath();/(?:^|>)BLOCKQUOTE/.test(e)||!/(?:^|>)[OU]L/.test(e)?t.decreaseQuoteLevel():t.decreaseListLevel()};N[k+"]"]=(t,i)=>{i.preventDefault();let e=t.getPath();/(?:^|>)BLOCKQUOTE/.test(e)||!/(?:^|>)[OU]L/.test(e)?t.increaseQuoteLevel():t.increaseListLevel()};N[k+"d"]=(t,i)=>{i.preventDefault(),t.toggleCode()};N[k+"z"]=(t,i)=>{i.preventDefault(),t.undo()};N[k+"y"]=N[k+"Shift-z"]=(t,i)=>{i.preventDefault(),t.redo()};var xi=class{_root;_config;_isFocused;_lastSelection;_willRestoreSelection;_mayHaveZWS;_lastAnchorNode;_lastFocusNode;_path;_events;_undoIndex;_undoStack;_undoStackLength;_isInUndoState;_ignoreChange;_ignoreAllChanges;_isShiftDown;_keyHandlers;_mutation;constructor(t,i){this._root=t,this._config=this._makeConfig(i),this._isFocused=!1,this._lastSelection=W(t,0),this._willRestoreSelection=!1,this._mayHaveZWS=!1,this._lastAnchorNode=null,this._lastFocusNode=null,this._path="",this._events=new Map,this._undoIndex=-1,this._undoStack=[],this._undoStackLength=0,this._isInUndoState=!1,this._ignoreChange=!1,this._ignoreAllChanges=!1,this.addEventListener("selectionchange",this._updatePathOnEvent),this.addEventListener("blur",this._enableRestoreSelection),this.addEventListener("mousedown",this._disableRestoreSelection),this.addEventListener("touchstart",this._disableRestoreSelection),this.addEventListener("focus",this._restoreSelection),this._isShiftDown=!1,this.addEventListener("cut",hi),this.addEventListener("copy",fi),this.addEventListener("paste",ui),this.addEventListener("drop",pi),this.addEventListener("keydown",Ht),this.addEventListener("keyup",Ht),this.addEventListener("keydown",_i),this._keyHandlers=Object.create(N);let e=new MutationObserver(()=>this._docWasChanged());e.observe(t,{childList:!0,attributes:!0,characterData:!0,subtree:!0}),this._mutation=e,t.setAttribute("contenteditable","true");try{document.execCommand("enableObjectResizing",!1,"false"),document.execCommand("enableInlineTableEditing",!1,"false")}catch{}this.addEventListener("beforeinput",this._beforeInput),this.setHTML("")}destroy(){this._events.forEach((t,i)=>{this.removeEventListener(i)}),this._mutation.disconnect(),this._undoIndex=-1,this._undoStack=[],this._undoStackLength=0}_makeConfig(t){let i={blockTag:"DIV",blockAttributes:null,tagAttributes:{},classNames:{color:"color",fontFamily:"font",fontSize:"size",highlight:"highlight"},undo:{documentSizeThreshold:-1,undoLimit:-1},addLinks:!0,willCutCopy:null,sanitizeToDOMFragment:e=>{let s=DOMPurify.sanitize(e,{ALLOW_UNKNOWN_PROTOCOLS:!0,WHOLE_DOCUMENT:!1,RETURN_DOM:!0,RETURN_DOM_FRAGMENT:!0,FORCE_BODY:!1});return s?document.importNode(s,!0):document.createDocumentFragment()},didError:e=>console.log(e)};return t&&(Object.assign(i,t),i.blockTag=i.blockTag.toUpperCase()),i}setKeyHandler(t,i){return this._keyHandlers[t]=i,this}_beforeInput(t){switch(t.inputType){case"insertText":Ke&&t.data&&t.data.includes(`
`)&&t.preventDefault();break;case"insertLineBreak":t.preventDefault(),this.splitBlock(!0);break;case"insertParagraph":t.preventDefault(),this.splitBlock(!1);break;case"insertOrderedList":t.preventDefault(),this.makeOrderedList();break;case"insertUnoderedList":t.preventDefault(),this.makeUnorderedList();break;case"historyUndo":t.preventDefault(),this.undo();break;case"historyRedo":t.preventDefault(),this.redo();break;case"formatBold":t.preventDefault(),this.bold();break;case"formaItalic":t.preventDefault(),this.italic();break;case"formatUnderline":t.preventDefault(),this.underline();break;case"formatStrikeThrough":t.preventDefault(),this.strikethrough();break;case"formatSuperscript":t.preventDefault(),this.superscript();break;case"formatSubscript":t.preventDefault(),this.subscript();break;case"formatJustifyFull":case"formatJustifyCenter":case"formatJustifyRight":case"formatJustifyLeft":{t.preventDefault();let i=t.inputType.slice(13).toLowerCase();i==="full"&&(i="justify"),this.setTextAlignment(i);break}case"formatRemove":t.preventDefault(),this.removeAllFormatting();break;case"formatSetBlockTextDirection":{t.preventDefault();let i=t.data;i==="null"&&(i=null),this.setTextDirection(i);break}case"formatBackColor":t.preventDefault(),this.setHighlightColor(t.data);break;case"formatFontColor":t.preventDefault(),this.setTextColor(t.data);break;case"formatFontName":t.preventDefault(),this.setFontFace(t.data);break}}handleEvent(t){this.fireEvent(t.type,t)}fireEvent(t,i){let e=this._events.get(t);if(/^(?:focus|blur)/.test(t)){let s=this._root===document.activeElement;if(t==="focus"){if(!s||this._isFocused)return this;this._isFocused=!0}else{if(s||!this._isFocused)return this;this._isFocused=!1}}if(e){let s=i instanceof Event?i:new CustomEvent(t,{detail:i});e=e.slice();for(let n of e)try{"handleEvent"in n?n.handleEvent(s):n.call(this,s)}catch(o){this._config.didError(o)}}return this}customEvents=new Set(["pathChange","select","input","pasteImage","undoStateChange"]);addEventListener(t,i){let e=this._events.get(t),s=this._root;return e||(e=[],this._events.set(t,e),this.customEvents.has(t)||(t==="selectionchange"&&(s=document),s.addEventListener(t,this,!0))),e.push(i),this}removeEventListener(t,i){let e=this._events.get(t),s=this._root;if(e){if(i){let n=e.length;for(;n--;)e[n]===i&&e.splice(n,1)}else e.length=0;e.length||(this._events.delete(t),this.customEvents.has(t)||(t==="selectionchange"&&(s=document),s.removeEventListener(t,this,!0)))}return this}focus(){return this._root.focus({preventScroll:!0}),this}blur(){return this._root.blur(),this}_enableRestoreSelection(){this._willRestoreSelection=!0}_disableRestoreSelection(){this._willRestoreSelection=!1}_restoreSelection(){this._willRestoreSelection&&this.setSelection(this._lastSelection)}_removeZWS(){this._mayHaveZWS&&(ht(this._root),this._mayHaveZWS=!1)}startSelectionId="squire-selection-start";endSelectionId="squire-selection-end";_saveRangeToBookmark(t){let i=m("INPUT",{id:this.startSelectionId,type:"hidden"}),e=m("INPUT",{id:this.endSelectionId,type:"hidden"}),s;R(t,i),t.collapse(!1),R(t,e),i.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_PRECEDING&&(i.id=this.endSelectionId,e.id=this.startSelectionId,s=i,i=e,e=s),t.setStartAfter(i),t.setEndBefore(e)}_getRangeAndRemoveBookmark(t){let i=this._root,e=i.querySelector("#"+this.startSelectionId),s=i.querySelector("#"+this.endSelectionId);if(e&&s){let n=e.parentNode,o=s.parentNode,r=Array.from(n.childNodes).indexOf(e),a=Array.from(o.childNodes).indexOf(s);n===o&&(a-=1),e.remove(),s.remove(),t||(t=document.createRange()),t.setStart(n,r),t.setEnd(o,a),Q(n,t),n!==o&&Q(o,t),t.collapsed&&(n=t.startContainer,n instanceof Text&&(o=n.childNodes[t.startOffset],(!o||!(o instanceof Text))&&(o=n.childNodes[t.startOffset-1]),o&&o instanceof Text&&(t.setStart(o,0),t.collapse(!0))))}return t||null}getSelection(){let t=window.getSelection(),i=this._root,e=null;if(this._isFocused&&t&&t.rangeCount){e=t.getRangeAt(0).cloneRange();let s=e.startContainer,n=e.endContainer;s&&q(s)&&e.setStartBefore(s),n&&q(n)&&e.setEndBefore(n)}return e&&i.contains(e.commonAncestorContainer)?this._lastSelection=e:(e=this._lastSelection,document.contains(e.commonAncestorContainer)||(e=null)),e||(e=W(i.firstElementChild||i,0)),e}setSelection(t){if(this._lastSelection=t,!this._isFocused)this._enableRestoreSelection();else{let i=window.getSelection();i&&("setBaseAndExtent"in Selection.prototype?i.setBaseAndExtent(t.startContainer,t.startOffset,t.endContainer,t.endOffset):(i.removeAllRanges(),i.addRange(t)))}return this}_moveCursorTo(t){let i=this._root,e=W(i,t?0:i.childNodes.length);return T(e),this.setSelection(e),this}moveCursorToStart(){return this._moveCursorTo(!0)}moveCursorToEnd(){return this._moveCursorTo(!1)}getCursorPosition(){let t=this.getSelection(),i=t.getBoundingClientRect();if(i&&!i.top){this._ignoreChange=!0;let e=m("SPAN");e.textContent=Y,R(t,e),i=e.getBoundingClientRect();let s=e.parentNode;s.removeChild(e),Q(s,t)}return i}getPath(){return this._path}_updatePathOnEvent(){this._isFocused&&this._updatePath(this.getSelection())}_updatePath(t,i){let e=t.startContainer,s=t.endContainer,n;(i||e!==this._lastAnchorNode||s!==this._lastFocusNode)&&(this._lastAnchorNode=e,this._lastFocusNode=s,n=e&&s?e===s?this._getPath(s):"(selection)":"",this._path!==n&&(this._path=n,this.fireEvent("pathChange",{path:n}))),this.fireEvent(t.collapsed?"cursor":"select",{range:t})}_getPath(t){let i=this._root,e=this._config,s="";if(t&&t!==i){let n=t.parentNode;if(s=n?this._getPath(n):"",t instanceof HTMLElement){let o=t.id,r=t.classList,a=Array.from(r).sort(),l=t.dir,c=e.classNames;s+=(s?">":"")+t.nodeName,o&&(s+="#"+o),a.length&&(s+=".",s+=a.join(".")),l&&(s+="[dir="+l+"]"),r.contains(c.highlight)&&(s+="[backgroundColor="+t.style.backgroundColor.replace(/ /g,"")+"]"),r.contains(c.color)&&(s+="[color="+t.style.color.replace(/ /g,"")+"]"),r.contains(c.fontFamily)&&(s+="[fontFamily="+t.style.fontFamily.replace(/ /g,"")+"]"),r.contains(c.fontSize)&&(s+="[fontSize="+t.style.fontSize+"]")}}return s}modifyDocument(t){let i=this._mutation;return i&&(i.takeRecords().length&&this._docWasChanged(),i.disconnect()),this._ignoreAllChanges=!0,t(),this._ignoreAllChanges=!1,i&&(i.observe(this._root,{childList:!0,attributes:!0,characterData:!0,subtree:!0}),this._ignoreChange=!1),this}_docWasChanged(){if(Je(),this._mayHaveZWS=!0,!this._ignoreAllChanges){if(this._ignoreChange){this._ignoreChange=!1;return}this._isInUndoState&&(this._isInUndoState=!1,this.fireEvent("undoStateChange",{canUndo:!0,canRedo:!1})),this.fireEvent("input")}}_recordUndoState(t,i){if(!this._isInUndoState||i){let e=this._undoIndex,s=this._undoStack,n=this._config.undo,o=n.documentSizeThreshold,r=n.undoLimit;i||(e+=1),e<this._undoStackLength&&(s.length=this._undoStackLength=e),t&&this._saveRangeToBookmark(t);let a=this._getRawHTML();o>-1&&a.length*2>o&&r>-1&&e>r&&(s.splice(0,e-r),e=r,this._undoStackLength=r),s[e]=a,this._undoIndex=e,this._undoStackLength+=1,this._isInUndoState=!0}return this}saveUndoState(t){return t||(t=this.getSelection()),this._recordUndoState(t,this._isInUndoState),this._getRangeAndRemoveBookmark(t),this}undo(){if(this._undoIndex!==0||!this._isInUndoState){this._recordUndoState(this.getSelection(),!1),this._undoIndex-=1,this._setRawHTML(this._undoStack[this._undoIndex]);let t=this._getRangeAndRemoveBookmark();t&&this.setSelection(t),this._isInUndoState=!0,this.fireEvent("undoStateChange",{canUndo:this._undoIndex!==0,canRedo:!0}),this.fireEvent("input")}return this}redo(){let t=this._undoIndex,i=this._undoStackLength;if(t+1<i&&this._isInUndoState){this._undoIndex+=1,this._setRawHTML(this._undoStack[this._undoIndex]);let e=this._getRangeAndRemoveBookmark();e&&this.setSelection(e),this.fireEvent("undoStateChange",{canUndo:!0,canRedo:t+2<i}),this.fireEvent("input")}return this}getRoot(){return this._root}_getRawHTML(){return this._root.innerHTML}_setRawHTML(t){let i=this._root;i.innerHTML=t;let e=i,s=e.firstChild;if(!s||s.nodeName==="BR"){let n=this.createDefaultBlock();s?e.replaceChild(n,s):e.appendChild(n)}else for(;e=z(e,i);)_(e);return this._ignoreChange=!0,this}getHTML(t){let i;t&&(i=this.getSelection(),this._saveRangeToBookmark(i));let e=this._getRawHTML().replace(/\u200B/g,"");return t&&this._getRangeAndRemoveBookmark(i),e}setHTML(t){let i=this._config.sanitizeToDOMFragment(t,this),e=this._root;vt(i,this._config),at(i,e,!1),D(i,e);let s=i,n=s.firstChild;if(!n||n.nodeName==="BR"){let r=this.createDefaultBlock();n?s.replaceChild(r,n):s.appendChild(r)}else for(;s=z(s,e);)_(s);for(this._ignoreChange=!0;n=e.lastChild;)e.removeChild(n);e.appendChild(i),this._undoIndex=-1,this._undoStack.length=0,this._undoStackLength=0,this._isInUndoState=!1;let o=this._getRangeAndRemoveBookmark()||W(e.firstElementChild||e,0);return this.saveUndoState(o),this.setSelection(o),this._updatePath(o,!0),this}insertHTML(t,i){let e=this._config,s=e.sanitizeToDOMFragment(t,this),n=this.getSelection();this.saveUndoState(n);try{let o=this._root;e.addLinks&&this.addDetectedLinks(s,s),vt(s,this._config),at(s,o,!1),Ct(s),s.normalize();let r=s;for(;r=z(r,s);)_(r);let a=!0;if(i){let l=new CustomEvent("willPaste",{detail:{fragment:s}});this.fireEvent("willPaste",l),s=l.detail.fragment,a=!l.defaultPrevented}a&&(ci(n,s,o),n.collapse(!1),Rt(n,"A",o),this._ensureBottomLine()),this.setSelection(n),this._updatePath(n,!0),i&&this.focus()}catch(o){this._config.didError(o)}return this}insertElement(t,i){if(i||(i=this.getSelection()),i.collapse(!0),v(t))R(i,t),i.setStartAfter(t);else{let e=this._root,s=B(i,e),n=s||e,o=null;for(;n!==e&&!n.nextSibling;)n=n.parentNode;if(n!==e){let a=n.parentNode;o=y(a,n.nextSibling,e,e)}s&&St(s)&&b(s),e.insertBefore(t,o);let r=this.createDefaultBlock();e.insertBefore(r,o),i.setStart(r,0),i.setEnd(r,0),T(i)}return this.focus(),this.setSelection(i),this._updatePath(i),this}insertImage(t,i){let e=m("IMG",Object.assign({src:t},i));return this.insertElement(e),e}insertPlainText(t,i){let e=this.getSelection();if(e.collapsed&&S(e.startContainer,this._root,"PRE")){let c=e.startContainer,d=e.startOffset,h;if(!c||!(c instanceof Text)){let u=document.createTextNode("");c.insertBefore(u,c.childNodes[d]),h=u,d=0}else h=c;let f=!0;if(i){let u=new CustomEvent("willPaste",{detail:{text:t}});this.fireEvent("willPaste",u),t=u.detail.text,f=!u.defaultPrevented}return f&&(h.insertData(d,t),e.setStart(h,d+t.length),e.collapse(!0)),this.setSelection(e),this}let s=t.split(`
`),n=this._config,o=n.blockTag,r=n.blockAttributes,a="</"+o+">",l="<"+o;for(let c in r)l+=" "+c+'="'+Pt(r[c])+'"';l+=">";for(let c=0,d=s.length;c<d;c+=1){let h=s[c];h=Pt(h).replace(/ (?=(?: |$))/g,"&nbsp;"),c&&(h=l+(h||"<BR>")+a),s[c]=h}return this.insertHTML(s.join(""),i)}getSelectedText(){let t=this.getSelection();if(t.collapsed)return"";let i=t.startContainer,e=t.endContainer,s=new A(t.commonAncestorContainer,K,l=>H(t,l,!0));s.currentNode=i;let n=i,o="",r=!1,a;for((!(n instanceof Element)&&!(n instanceof Text)||!s.filter(n))&&(n=s.nextNode());n;)n instanceof Text?(a=n.data,a&&/\S/.test(a)&&(n===e&&(a=a.slice(0,t.endOffset)),n===i&&(a=a.slice(t.startOffset)),o+=a,r=!0)):(n.nodeName==="BR"||r&&!v(n))&&(o+=`
`,r=!1),n=s.nextNode();return o}getFontInfo(t){let i={color:void 0,backgroundColor:void 0,fontFamily:void 0,fontSize:void 0};t||(t=this.getSelection());let e=0,s=t.commonAncestorContainer;if(t.collapsed||s instanceof Text)for(s instanceof Text&&(s=s.parentNode);e<4&&s;){let n=s.style;if(n){let o=n.color;!i.color&&o&&(i.color=o,e+=1);let r=n.backgroundColor;!i.backgroundColor&&r&&(i.backgroundColor=r,e+=1);let a=n.fontFamily;!i.fontFamily&&a&&(i.fontFamily=a,e+=1);let l=n.fontSize;!i.fontSize&&l&&(i.fontSize=l,e+=1)}s=s.parentNode}return i}hasFormat(t,i,e){t=t.toUpperCase(),i||(i={}),e||(e=this.getSelection()),!e.collapsed&&e.startContainer instanceof Text&&e.startOffset===e.startContainer.length&&e.startContainer.nextSibling&&e.setStartBefore(e.startContainer.nextSibling),!e.collapsed&&e.endContainer instanceof Text&&e.endOffset===0&&e.endContainer.previousSibling&&e.setEndAfter(e.endContainer.previousSibling);let s=this._root,n=e.commonAncestorContainer;if(S(n,s,t,i))return!0;if(n instanceof Text)return!1;let o=new A(n,j,l=>H(e,l,!0)),r=!1,a;for(;a=o.nextNode();){if(!S(a,s,t,i))return!1;r=!0}return r}changeFormat(t,i,e,s){return e||(e=this.getSelection()),this.saveUndoState(e),i&&(e=this._removeFormat(i.tag.toUpperCase(),i.attributes||{},e,s)),t&&(e=this._addFormat(t.tag.toUpperCase(),t.attributes||{},e)),this.setSelection(e),this._updatePath(e,!0),this.focus()}_addFormat(t,i,e){let s=this._root;if(e.collapsed){let n=_(m(t,i));R(e,n);let o=n.firstChild||n,r=o instanceof Text?o.length:0;e.setStart(o,r),e.collapse(!0);let a=n;for(;v(a);)a=a.parentNode;ht(a,n)}else{let n=new A(e.commonAncestorContainer,K,c=>(c instanceof Text||c.nodeName==="BR"||c.nodeName==="IMG")&&H(e,c,!0)),{startContainer:o,startOffset:r,endContainer:a,endOffset:l}=e;if(n.currentNode=o,!(o instanceof Element)&&!(o instanceof Text)||!n.filter(o)){let c=n.nextNode();if(!c)return e;o=c,r=0}do{let c=n.currentNode;if(!S(c,s,t,i)){c===a&&c.length>l&&c.splitText(l),c===o&&r&&(c=c.splitText(r),a===o?(a=c,l-=r):a===o.parentNode&&(l+=1),o=c,r=0);let h=m(t,i);w(c,h),h.appendChild(c)}}while(n.nextNode());e=W(o,r,a,l)}return e}_removeFormat(t,i,e,s){this._saveRangeToBookmark(e);let n;e.collapsed&&(ut?n=document.createTextNode(Y):n=document.createTextNode(""),R(e,n));let o=e.commonAncestorContainer;for(;v(o);)o=o.parentNode;let r=e.startContainer,a=e.startOffset,l=e.endContainer,c=e.endOffset,d=[],h=(u,p)=>{if(H(e,u,!1))return;let C,x;if(!H(e,u,!0)){!(u instanceof HTMLInputElement)&&(!(u instanceof Text)||u.data)&&d.push([p,u]);return}if(u instanceof Text)u===l&&c!==u.length&&d.push([p,u.splitText(c)]),u===r&&a&&(u.splitText(a),d.push([p,u]));else for(C=u.firstChild;C;C=x)x=C.nextSibling,h(C,p)},f=Array.from(o.getElementsByTagName(t)).filter(u=>H(e,u,!0)&&mt(u,t,i));return s||f.forEach(u=>{h(u,u)}),d.forEach(([u,p])=>{u=u.cloneNode(!1),w(p,u),u.appendChild(p)}),f.forEach(u=>{w(u,g(u))}),this._getRangeAndRemoveBookmark(e),n&&e.collapse(!1),Q(o,e),e}bold(){return this.changeFormat({tag:"B"})}removeBold(){return this.changeFormat(null,{tag:"B"})}italic(){return this.changeFormat({tag:"I"})}removeItalic(){return this.changeFormat(null,{tag:"I"})}underline(){return this.changeFormat({tag:"U"})}removeUnderline(){return this.changeFormat(null,{tag:"U"})}strikethrough(){return this.changeFormat({tag:"S"})}removeStrikethrough(){return this.changeFormat(null,{tag:"S"})}subscript(){return this.changeFormat({tag:"SUB"},{tag:"SUP"})}removeSubscript(){return this.changeFormat(null,{tag:"SUB"})}superscript(){return this.changeFormat({tag:"SUP"},{tag:"SUB"})}removeSuperscript(){return this.changeFormat(null,{tag:"SUP"})}makeLink(t,i){let e=this.getSelection();if(e.collapsed){let s=t.indexOf(":")+1;if(s)for(;t[s]==="/";)s+=1;R(e,document.createTextNode(t.slice(s)))}return i=Object.assign({href:t},this._config.tagAttributes.a,i),this.changeFormat({tag:"A",attributes:i},{tag:"A"},e)}removeLink(){return this.changeFormat(null,{tag:"A"},this.getSelection(),!0)}linkRegExp=/\b(?:((?:(?:ht|f)tps?:\/\/|www\d{0,3}[.]|[a-z0-9][a-z0-9.\-]*[.][a-z]{2,}\/)(?:[^\s()<>]+|\([^\s()<>]+\))+(?:[^\s?&`!()\[\]{};:'".,<>«»“”‘’]|\([^\s()<>]+\)))|([\w\-.%+]+@(?:[\w\-]+\.)+[a-z]{2,}\b(?:[?][^&?\s]+=[^\s?&`!()\[\]{};:'".,<>«»“”‘’]+(?:&[^&?\s]+=[^\s?&`!()\[\]{};:'".,<>«»“”‘’]+)*)?))/i;addDetectedLinks(t,i){let e=new A(t,j,r=>!S(r,i||this._root,"A")),s=this.linkRegExp,n=this._config.tagAttributes.a,o;for(;o=e.nextNode();){let r=o.parentNode,a=o.data,l;for(;l=s.exec(a);){let c=l.index,d=c+l[0].length;c&&r.insertBefore(document.createTextNode(a.slice(0,c)),o);let h=m("A",Object.assign({href:l[1]?/^(?:ht|f)tps?:/i.test(l[1])?l[1]:"http://"+l[1]:"mailto:"+l[0]},n));h.textContent=a.slice(c,d),r.insertBefore(h,o),o.data=a=a.slice(d)}}return this}setFontFace(t){let i=this._config.classNames.fontFamily;return this.changeFormat(t?{tag:"SPAN",attributes:{class:i,style:"font-family: "+t+", sans-serif;"}}:null,{tag:"SPAN",attributes:{class:i}})}setFontSize(t){let i=this._config.classNames.fontSize;return this.changeFormat(t?{tag:"SPAN",attributes:{class:i,style:"font-size: "+(typeof t=="number"?t+"px":t)}}:null,{tag:"SPAN",attributes:{class:i}})}setTextColor(t){let i=this._config.classNames.color;return this.changeFormat(t?{tag:"SPAN",attributes:{class:i,style:"color:"+t}}:null,{tag:"SPAN",attributes:{class:i}})}setHighlightColor(t){let i=this._config.classNames.highlight;return this.changeFormat(t?{tag:"SPAN",attributes:{class:i,style:"background-color:"+t}}:null,{tag:"SPAN",attributes:{class:i}})}_ensureBottomLine(){let t=this._root,i=t.lastElementChild;(!i||i.nodeName!==this._config.blockTag||!U(i))&&t.appendChild(this.createDefaultBlock())}createDefaultBlock(t){let i=this._config;return _(m(i.blockTag,i.blockAttributes,t))}tagAfterSplit={DT:"DD",DD:"DT",LI:"LI",PRE:"PRE"};splitBlock(t,i){i||(i=this.getSelection());let e=this._root,s,n,o,r;if(this._recordUndoState(i),this._removeZWS(),this._getRangeAndRemoveBookmark(i),i.collapsed||G(i,e),this._config.addLinks){T(i);let h=i.startContainer,f=i.startOffset;setTimeout(()=>{te(this,h,f)},0)}if(s=B(i,e),s&&(n=S(s,e,"PRE"))){T(i),o=i.startContainer;let h=i.startOffset;return o instanceof Text||(o=document.createTextNode(""),n.insertBefore(o,n.firstChild)),!t&&o instanceof Text&&(o.data.charAt(h-1)===`
`||st(i,e))&&(o.data.charAt(h)===`
`||dt(i,e))?(o.deleteData(h&&h-1,h?2:1),r=y(o,h&&h-1,e,e),o=r.previousSibling,o.textContent||b(o),o=this.createDefaultBlock(),r.parentNode.insertBefore(o,r),r.textContent||b(r),i.setStart(o,0)):(o.insertData(h,`
`),_(n),o.length===h+1?i.setStartAfter(o):i.setStart(o,h+1)),i.collapse(!0),this.setSelection(i),this._updatePath(i,!0),this._docWasChanged(),this}if(!s||t||/^T[HD]$/.test(s.nodeName))return Rt(i,"A",e),R(i,m("BR")),i.collapse(!1),this.setSelection(i),this._updatePath(i,!0),this;if((n=S(s,e,"LI"))&&(s=n),St(s)){if(S(s,e,"UL")||S(s,e,"OL"))return this.decreaseListLevel(i),this;if(S(s,e,"BLOCKQUOTE"))return this.removeQuote(i),this}o=i.startContainer;let a=i.startOffset,l=this.tagAfterSplit[s.nodeName];r=y(o,a,s.parentNode,this._root);let c=this._config,d=null;for(l||(l=c.blockTag,d=c.blockAttributes),mt(r,l,d)||(s=m(l,d),r.dir&&(s.dir=r.dir),w(r,s),s.appendChild(g(r)),r=s),ht(s),Ct(s),_(s);r instanceof Element;){let h=r.firstChild,f;if(r.nodeName==="A"&&(!r.textContent||r.textContent===Y)){h=document.createTextNode(""),w(r,h),r=h;break}for(;h&&h instanceof Text&&!h.data&&(f=h.nextSibling,!(!f||f.nodeName==="BR"));)b(h),h=f;if(!h||h.nodeName==="BR"||h instanceof Text)break;r=h}return i=W(r,0),this.setSelection(i),this._updatePath(i,!0),this}forEachBlock(t,i,e){e||(e=this.getSelection()),i&&this.saveUndoState(e);let s=this._root,n=B(e,s),o=$(e,s);if(n&&o)do if(t(n)||n===o)break;while(n=z(n,s));return i&&(this.setSelection(e),this._updatePath(e,!0)),this}modifyBlocks(t,i){i||(i=this.getSelection()),this._recordUndoState(i,this._isInUndoState);let e=this._root;Ft(i,e),V(i,e,e,e);let s=Yt(i,e,e);if(!i.collapsed){let n=i.endContainer;if(n===e)i.collapse(!1);else{for(;n.parentNode!==e;)n=n.parentNode;i.setStartBefore(n),i.collapse(!0)}}return R(i,t.call(this,s)),i.endOffset<i.endContainer.childNodes.length&&P(i.endContainer.childNodes[i.endOffset],e),P(i.startContainer.childNodes[i.startOffset],e),this._getRangeAndRemoveBookmark(i),this.setSelection(i),this._updatePath(i,!0),this}setTextAlignment(t){return this.forEachBlock(i=>{let e=i.className.split(/\s+/).filter(s=>!!s&&!/^align/.test(s)).join(" ");t?(i.className=e+" align-"+t,i.style.textAlign=t):(i.className=e,i.style.textAlign="")},!0),this.focus()}setTextDirection(t){return this.forEachBlock(i=>{t?i.dir=t:i.removeAttribute("dir")},!0),this.focus()}_getListSelection(t,i){let e=t.commonAncestorContainer,s=t.startContainer,n=t.endContainer;for(;e&&e!==i&&!/^[OU]L$/.test(e.nodeName);)e=e.parentNode;if(!e||e===i)return null;for(s===e&&(s=s.childNodes[t.startOffset]),n===e&&(n=n.childNodes[t.endOffset]);s&&s.parentNode!==e;)s=s.parentNode;for(;n&&n.parentNode!==e;)n=n.parentNode;return[e,s,n]}increaseListLevel(t){t||(t=this.getSelection());let i=this._root,e=this._getListSelection(t,i);if(!e)return this.focus();let[s,n,o]=e;if(!n||n===s.firstChild)return this.focus();this._recordUndoState(t,this._isInUndoState);let r=s.nodeName,a=n.previousSibling,l,c;a.nodeName!==r&&(l=this._config.tagAttributes[r.toLowerCase()],a=m(r,l),s.insertBefore(a,n));do c=n===o?null:n.nextSibling,a.appendChild(n);while(n=c);return c=a.nextSibling,c&&P(c,i),this._getRangeAndRemoveBookmark(t),this.setSelection(t),this._updatePath(t,!0),this.focus()}decreaseListLevel(t){t||(t=this.getSelection());let i=this._root,e=this._getListSelection(t,i);if(!e)return this.focus();let[s,n,o]=e;n||(n=s.firstChild),o||(o=s.lastChild),this._recordUndoState(t,this._isInUndoState);let r,a=null;if(n){let l=s.parentNode;if(a=o.nextSibling?y(s,o.nextSibling,l,i):s.nextSibling,l!==i&&l.nodeName==="LI"){for(l=l.parentNode;a;)r=a.nextSibling,o.appendChild(a),a=r;a=s.parentNode.nextSibling}let c=!/^[OU]L$/.test(l.nodeName);do r=n===o?null:n.nextSibling,s.removeChild(n),c&&n.nodeName==="LI"&&(n=this.createDefaultBlock([g(n)])),l.insertBefore(n,a);while(n=r)}return s.firstChild||b(s),a&&P(a,i),this._getRangeAndRemoveBookmark(t),this.setSelection(t),this._updatePath(t,!0),this.focus()}_makeList(t,i){let e=lt(t,this._root),s=this._config.tagAttributes,n=s[i.toLowerCase()],o=s.li,r;for(;r=e.nextNode();)if(r.parentNode instanceof HTMLLIElement&&(r=r.parentNode,e.currentNode=r.lastChild),r instanceof HTMLLIElement){r=r.parentNode;let a=r.nodeName;a!==i&&/^[OU]L$/.test(a)&&w(r,m(i,n,[g(r)]))}else{let a=m("LI",o);r.dir&&(a.dir=r.dir);let l=r.previousSibling;l&&l.nodeName===i?(l.appendChild(a),b(r)):w(r,m(i,n,[a])),a.appendChild(g(r)),e.currentNode=a}return t}makeUnorderedList(){return this.modifyBlocks(t=>this._makeList(t,"UL")),this.focus()}makeOrderedList(){return this.modifyBlocks(t=>this._makeList(t,"OL")),this.focus()}removeList(){return this.modifyBlocks(t=>{let i=t.querySelectorAll("UL, OL"),e=t.querySelectorAll("LI"),s=this._root;for(let n=0,o=i.length;n<o;n+=1){let r=i[n],a=g(r);D(a,s),w(r,a)}for(let n=0,o=e.length;n<o;n+=1){let r=e[n];U(r)?w(r,this.createDefaultBlock([g(r)])):(D(r,s),w(r,g(r)))}return t}),this.focus()}increaseQuoteLevel(t){return this.modifyBlocks(i=>m("BLOCKQUOTE",this._config.tagAttributes.blockquote,[i]),t),this.focus()}decreaseQuoteLevel(t){return this.modifyBlocks(i=>(Array.from(i.querySelectorAll("blockquote")).filter(e=>!S(e.parentNode,i,"BLOCKQUOTE")).forEach(e=>{w(e,g(e))}),i),t),this.focus()}removeQuote(t){return this.modifyBlocks(()=>this.createDefaultBlock([m("INPUT",{id:this.startSelectionId,type:"hidden"}),m("INPUT",{id:this.endSelectionId,type:"hidden"})]),t),this.focus()}code(){let t=this.getSelection();return t.collapsed||J(t.commonAncestorContainer)?(this.modifyBlocks(i=>{let e=this._root,s=document.createDocumentFragment(),n=lt(i,e),o;for(;o=n.nextNode();){let a=o.querySelectorAll("BR"),l=[],c=a.length;for(let d=0;d<c;d+=1)l[d]=ct(a[d],!1);for(;c--;){let d=a[c];l[c]?w(d,document.createTextNode(`
`)):b(d)}for(a=o.querySelectorAll("CODE"),c=a.length;c--;)w(a[c],g(a[c]));s.childNodes.length&&s.appendChild(document.createTextNode(`
`)),s.appendChild(g(o))}let r=new A(s,j);for(;o=r.nextNode();)o.data=o.data.replace(/ /g," ");return s.normalize(),_(m("PRE",this._config.tagAttributes.pre,[s]))},t),this.focus()):this.changeFormat({tag:"CODE",attributes:this._config.tagAttributes.code},null,t),this}removeCode(){let t=this.getSelection(),i=t.commonAncestorContainer;return S(i,this._root,"PRE")?(this.modifyBlocks(s=>{let n=this._root,o=s.querySelectorAll("PRE"),r=o.length;for(;r--;){let a=o[r],l=new A(a,j),c;for(;c=l.nextNode();){let d=c.data;d=d.replace(/ (?= )/g,"\xA0");let h=document.createDocumentFragment(),f;for(;(f=d.indexOf(`
`))>-1;)h.appendChild(document.createTextNode(d.slice(0,f))),h.appendChild(m("BR")),d=d.slice(f+1);c.parentNode.insertBefore(h,c),c.data=d}D(a,n),w(a,g(a))}return s},t),this.focus()):this.changeFormat(null,{tag:"CODE"},t),this}toggleCode(){return this.hasFormat("PRE")||this.hasFormat("CODE")?this.removeCode():this.code(),this}_removeFormatting(t,i){for(let e=t.firstChild,s;e;e=s){if(s=e.nextSibling,v(e)){if(e instanceof Text||e.nodeName==="BR"||e.nodeName==="IMG"){i.appendChild(e);continue}}else if(U(e)){i.appendChild(this.createDefaultBlock([this._removeFormatting(e,document.createDocumentFragment())]));continue}this._removeFormatting(e,i)}return i}removeAllFormatting(t){if(t||(t=this.getSelection()),t.collapsed)return this.focus();let i=this._root,e=t.commonAncestorContainer;for(;e&&!U(e);)e=e.parentNode;if(e||(Ft(t,i),e=i),e instanceof Text)return this.focus();this.saveUndoState(t),V(t,e,e,i);let s=t.startContainer,n=t.startOffset,o=t.endContainer,r=t.endOffset,a=document.createDocumentFragment(),l=document.createDocumentFragment(),c=y(o,r,e,i),d=y(s,n,e,i),h;for(;d!==c;)h=d.nextSibling,a.appendChild(d),d=h;if(this._removeFormatting(a,l),l.normalize(),d=l.firstChild,h=l.lastChild,d){e.insertBefore(l,c);let f=Array.from(e.childNodes);n=f.indexOf(d),r=h?f.indexOf(h)+1:0}else c&&(n=Array.from(e.childNodes).indexOf(c),r=n);return t.setStart(e,n),t.setEnd(e,r),Q(e,t),T(t),this.setSelection(t),this._updatePath(t,!0),this.focus()}},ee=xi;var xt=t=>typeof t=="string";var bt=t=>t.split(".").reduce((i,e)=>i[e],window);var ie=t=>{xt(t)&&(t=t[0]=="{"?JSON.parse(t):bt(t));for(let[i,e]of Object.entries(t))if(e&&typeof e=="object"){let s=e.__fn;xt(s)?t[i]=bt(s):ie(e)}return t},se=ie;var ne=t=>{let i=t;do{if(i.nextSibling){t.parsedCallback();return}i=i.parentNode}while(i);setTimeout(()=>{ne(t)})},oe=ne;var Tt,wt=class extends HTMLElement{connectedCallback(){Tt&&clearTimeout(Tt),oe(this)}disconnectedCallback(){this.disconnected(),Tt=setTimeout(()=>{this.destroyed(),this.config=null},1e3)}parsedCallback(){this.config||(this.config=se(this.dataset.config||{}),this.created()),this.connected()}created(){}destroyed(){}connected(){}disconnected(){}},re=wt;var Lt=class extends re{get events(){return[]}connectedCallback(){this.handleEvent=i=>{this[`$${i.type}`](i)},super.connectedCallback(),this.events.forEach(i=>{this.addEventListener(i,this)})}disconnectedCallback(){this.events.forEach(i=>{this.removeEventListener(i,this)}),super.disconnectedCallback()}},ae=Lt;var F=(t,i={})=>{let e=document.createElement(t);for(let[s,n]of Object.entries(i))e[s]=n;return e};function bi(t,i,e){return i=i||t,e.nodeType==1&&(i=`:scope ${i}`),i}function M(t,i=null,e=document){return e.querySelector(bi(t,i,e))}var le=t=>{let i=F("template");return i.innerHTML=t,i.content};function kt(t,i,e=!1){window.Sanitizer&&!e?t.setHTML(i):window.DOMPurify?t.innerHTML=window.DOMPurify.sanitize(i,{WHOLE_DOCUMENT:!1,FORCE_BODY:!1}):t.innerHTML=i}async function ce(t=!1){(!window.Sanitizer||t)&&!window.DOMPurify&&(window.DOMPurify=(await import("https://cdn.jsdelivr.net/npm/dompurify@3/+esm")).default)}var Et=()=>!!window.bootstrap;var de=`<svg width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
<path d="M8.21 13c2.106 0 3.412-1.087 3.412-2.823 0-1.306-.984-2.283-2.324-2.386v-.055a2.176 2.176 0 0 0 1.852-2.14c0-1.51-1.162-2.46-3.014-2.46H3.843V13H8.21zM5.908 4.674h1.696c.963 0 1.517.451 1.517 1.244 0 .834-.629 1.32-1.73 1.32H5.908V4.673zm0 6.788V8.598h1.73c1.217 0 1.88.492 1.88 1.415 0 .943-.643 1.449-1.832 1.449H5.907z"/>
</svg>`,he=`<svg width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
<path d="M7.991 11.674 9.53 4.455c.123-.595.246-.71 1.347-.807l.11-.52H7.211l-.11.52c1.06.096 1.128.212 1.005.807L6.57 11.674c-.123.595-.246.71-1.346.806l-.11.52h3.774l.11-.52c-1.06-.095-1.129-.211-1.006-.806z"/>
</svg>`,fe=`<svg width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
<path d="M5.313 3.136h-1.23V9.54c0 2.105 1.47 3.623 3.917 3.623s3.917-1.518 3.917-3.623V3.136h-1.23v6.323c0 1.49-.978 2.57-2.687 2.57-1.709 0-2.687-1.08-2.687-2.57V3.136zM12.5 15h-9v-1h9v1z"/>
</svg>`,ue=`<svg width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
<path d="M6.333 5.686c0 .31.083.581.27.814H5.166a2.776 2.776 0 0 1-.099-.76c0-1.627 1.436-2.768 3.48-2.768 1.969 0 3.39 1.175 3.445 2.85h-1.23c-.11-1.08-.964-1.743-2.25-1.743-1.23 0-2.18.602-2.18 1.607zm2.194 7.478c-2.153 0-3.589-1.107-3.705-2.81h1.23c.144 1.06 1.129 1.703 2.544 1.703 1.34 0 2.31-.705 2.31-1.675 0-.827-.547-1.374-1.914-1.675L8.046 8.5H1v-1h14v1h-3.504c.468.437.675.994.675 1.697 0 1.826-1.436 2.967-3.644 2.967z"/>
</svg>`,pe=`<svg width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
<path d="M5.854 4.854a.5.5 0 1 0-.708-.708l-3.5 3.5a.5.5 0 0 0 0 .708l3.5 3.5a.5.5 0 0 0 .708-.708L2.707 8l3.147-3.146zm4.292 0a.5.5 0 0 1 .708-.708l3.5 3.5a.5.5 0 0 1 0 .708l-3.5 3.5a.5.5 0 0 1-.708-.708L13.293 8l-3.147-3.146z"/>
</svg>`,me=`<svg width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
<path d="M4.715 6.542 3.343 7.914a3 3 0 1 0 4.243 4.243l1.828-1.829A3 3 0 0 0 8.586 5.5L8 6.086a1.002 1.002 0 0 0-.154.199 2 2 0 0 1 .861 3.337L6.88 11.45a2 2 0 1 1-2.83-2.83l.793-.792a4.018 4.018 0 0 1-.128-1.287z"/>
<path d="M6.586 4.672A3 3 0 0 0 7.414 9.5l.775-.776a2 2 0 0 1-.896-3.346L9.12 3.55a2 2 0 1 1 2.83 2.83l-.793.792c.112.42.155.855.128 1.287l1.372-1.372a3 3 0 1 0-4.243-4.243L6.586 4.672z"/>
</svg>`,ve=`<svg width="16" height="16" fill="currentColor" viewBox="0 0 24 24">
<path d="M13.2 6a1 1 0 0 1 0 .2l-2.6 10a1 1 0 0 1-1 .8h-.2a.8.8 0 0 1-.8-1l2.6-10H8a1 1 0 1 1 0-2h9a1 1 0 0 1 0 2h-3.8ZM5 18h7a1 1 0 0 1 0 2H5a1 1 0 0 1 0-2Zm13 1.5L16.5 18 15 19.5a.7.7 0 0 1-1-1l1.5-1.5-1.5-1.5a.7.7 0 0 1 1-1l1.5 1.5 1.5-1.5a.7.7 0 0 1 1 1L17.5 17l1.5 1.5a.7.7 0 0 1-1 1Z" fill-rule="evenodd"></path>
</svg>`;var Ce=`<svg width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
<path d="M8.637 13V3.669H7.379V7.62H2.758V3.67H1.5V13h1.258V8.728h4.62V13h1.259zm5.329 0V3.669h-1.244L10.5 5.316v1.265l2.16-1.565h.062V13h1.244z"/>
</svg>`,Se=`<svg width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
<path d="M7.638 13V3.669H6.38V7.62H1.759V3.67H.5V13h1.258V8.728h4.62V13h1.259zm3.022-6.733v-.048c0-.889.63-1.668 1.716-1.668.957 0 1.675.608 1.675 1.572 0 .855-.554 1.504-1.067 2.085l-3.513 3.999V13H15.5v-1.094h-4.245v-.075l2.481-2.844c.875-.998 1.586-1.784 1.586-2.953 0-1.463-1.155-2.556-2.919-2.556-1.941 0-2.966 1.326-2.966 2.74v.049h1.223z"/>
</svg>`,ge=`<svg width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
<path d="M7.637 13V3.669H6.379V7.62H1.758V3.67H.5V13h1.258V8.728h4.62V13h1.259zm3.625-4.272h1.018c1.142 0 1.935.67 1.949 1.674.013 1.005-.78 1.737-2.01 1.73-1.08-.007-1.853-.588-1.935-1.32H9.108c.069 1.327 1.224 2.386 3.083 2.386 1.935 0 3.343-1.155 3.309-2.789-.027-1.51-1.251-2.16-2.037-2.249v-.068c.704-.123 1.764-.91 1.723-2.229-.035-1.353-1.176-2.4-2.954-2.385-1.873.006-2.857 1.162-2.898 2.358h1.196c.062-.69.711-1.299 1.696-1.299.998 0 1.695.622 1.695 1.525.007.922-.718 1.592-1.695 1.592h-.964v1.074z"/>
</svg>`,Ne=`<svg width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
<path fill-rule="evenodd" d="M5 11.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5zm-3 1a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm0 4a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm0 4a1 1 0 1 0 0-2 1 1 0 0 0 0 2z"/>
</svg>`,_e=`<svg width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
<path fill-rule="evenodd" d="M5 11.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5z"/>
<path d="M1.713 11.865v-.474H2c.217 0 .363-.137.363-.317 0-.185-.158-.31-.361-.31-.223 0-.367.152-.373.31h-.59c.016-.467.373-.787.986-.787.588-.002.954.291.957.703a.595.595 0 0 1-.492.594v.033a.615.615 0 0 1 .569.631c.003.533-.502.8-1.051.8-.656 0-1-.37-1.008-.794h.582c.008.178.186.306.422.309.254 0 .424-.145.422-.35-.002-.195-.155-.348-.414-.348h-.3zm-.004-4.699h-.604v-.035c0-.408.295-.844.958-.844.583 0 .96.326.96.756 0 .389-.257.617-.476.848l-.537.572v.03h1.054V9H1.143v-.395l.957-.99c.138-.142.293-.304.293-.508 0-.18-.147-.32-.342-.32a.33.33 0 0 0-.342.338v.041zM2.564 5h-.635V2.924h-.031l-.598.42v-.567l.629-.443h.635V5z"/>
</svg>`,xe=`<svg width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
<path d="M12 12a1 1 0 0 0 1-1V8.558a1 1 0 0 0-1-1h-1.388c0-.351.021-.703.062-1.054.062-.372.166-.703.31-.992.145-.29.331-.517.559-.683.227-.186.516-.279.868-.279V3c-.579 0-1.085.124-1.52.372a3.322 3.322 0 0 0-1.085.992 4.92 4.92 0 0 0-.62 1.458A7.712 7.712 0 0 0 9 7.558V11a1 1 0 0 0 1 1h2Zm-6 0a1 1 0 0 0 1-1V8.558a1 1 0 0 0-1-1H4.612c0-.351.021-.703.062-1.054.062-.372.166-.703.31-.992.145-.29.331-.517.559-.683.227-.186.516-.279.868-.279V3c-.579 0-1.085.124-1.52.372a3.322 3.322 0 0 0-1.085.992 4.92 4.92 0 0 0-.62 1.458A7.712 7.712 0 0 0 3 7.558V11a1 1 0 0 0 1 1h2Z"/>
</svg>`,be=`<svg width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
<path d="M6.002 5.5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0z"/>
<path d="M2.002 1a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V3a2 2 0 0 0-2-2h-12zm12 1a1 1 0 0 1 1 1v6.5l-3.777-1.947a.5.5 0 0 0-.577.093l-3.71 3.71-2.66-1.772a.5.5 0 0 0-.63.062L1.002 12V3a1 1 0 0 1 1-1h12z"/>
</svg>`;var Te=`<svg width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
<path fill-rule="evenodd" d="M8 3a5 5 0 1 1-4.546 2.914.5.5 0 0 0-.908-.417A6 6 0 1 0 8 2v1z"/>
<path d="M8 4.466V.534a.25.25 0 0 0-.41-.192L5.23 2.308a.25.25 0 0 0 0 .384l2.36 1.966A.25.25 0 0 0 8 4.466z"/>
</svg>`,we=`<svg width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
<path fill-rule="evenodd" d="M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2v1z"/>
<path d="M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466z"/>
</svg>`,Le=`<svg width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
<path fill-rule="evenodd" d="M14 4.5V11h-1V4.5h-2A1.5 1.5 0 0 1 9.5 3V1H4a1 1 0 0 0-1 1v9H2V2a2 2 0 0 1 2-2h5.5L14 4.5Zm-9.736 7.35v3.999h-.791v-1.714H1.79v1.714H1V11.85h.791v1.626h1.682V11.85h.79Zm2.251.662v3.337h-.794v-3.337H4.588v-.662h3.064v.662H6.515Zm2.176 3.337v-2.66h.038l.952 2.159h.516l.946-2.16h.038v2.661h.715V11.85h-.8l-1.14 2.596H9.93L8.79 11.85h-.805v3.999h.706Zm4.71-.674h1.696v.674H12.61V11.85h.79v3.325Z"/>
</svg>`;var ke=!1,wi="squire-editor";function Ae(t,i,e){if(e.style.height&&(e.dataset.fixedHeight="1"),(e.style.height||e.style.maxHeight)&&(t&&(t.style.height=e.style.height,t.style.maxHeight=e.style.maxHeight,t.style.overflowY="scroll",t.style.borderTopRightRadius="0",t.style.borderBottomRightRadius="0"),e.style.borderTopRightRadius="0",e.style.borderBottomRightRadius="0",e.style.overflowY="scroll"),!t||!i)return;let s=window.getComputedStyle(t),n=window.getComputedStyle(i),o=window.getComputedStyle(e),r=t.offsetWidth-t.clientWidth;t.dataset.defaultPadding||(t.dataset.defaultPadding=s.paddingTop),e.dataset.defaultPadding||(e.dataset.defaultPadding=o.paddingTop),i.style.top=`${s.borderTopWidth}`,i.style.left=`${s.borderLeftWidth}`,i.style.right=`${parseInt(s.borderRightWidth)+r}px`,!e.style.height&&!e.style.maxHeight&&(i.style.borderTopRightRadius=`${o.borderTopRightRadius}`),i.style.borderTopLeftRadius=`${o.borderTopLeftRadius}`,t.style.paddingTop=`calc(${t.dataset.defaultPadding} + ${n.height})`,e.style.paddingTop=`calc(${e.dataset.defaultPadding} + ${n.height})`}function Li(t,i,e){t.format&&(e.hasFormat(t.format)?i.classList.add("is-active"):i.classList.remove("is-active"))}var Ee=new ResizeObserver(t=>{for(let i of t){let e=i.target,s=e.offsetWidth.toString();if(s!=e.dataset.width&&(e.dataset.width=s,i.contentBoxSize)){let n=M("textarea",null,e),o=M("div",".squire-input",e),r=M("div",".squire-toolbar",e);Ae(o,r,n)}}}),At=class extends ae{get el(){return M("textarea",null,this)}get value(){return this.el.value}created(){if(!this.el){let e=F("textarea",{name:this.getAttribute("name"),value:this.getAttribute("value")});Et()&&e.classList.add("form-control"),this.appendChild(e)}this.classList.add(wi);let i=this.el;i.setAttribute("hidden",""),i.spellcheck=!1,this.init()}async init(){await ce(ke);let i=M("div",".squire-toolbar",this),e=M("div",".squire-input",this);i&&i.remove(),e&&e.remove();let s=!this.dataset.toolbar;if(this.buttons=[],s){i=F("div"),i.classList.add("squire-toolbar"),this.appendChild(i);let a=[[{name:"bold",action:"bold",format:"b",removeAction:"removeBold",icon:de},{name:"italic",action:"italic",format:"i",removeAction:"removeItalic",icon:he},{name:"underline",action:"underline",format:"u",removeAction:"removeUnderline",icon:fe},{name:"strikethrough",action:"strikethrough",format:"s",removeAction:"removeStrikethrough",icon:ue},{name:"code",action:"code",format:"code",removeAction:"removeCode",icon:pe},{name:"link",action:"makeLink",prompt:!0,format:"a",removeAction:"removeLink",icon:me},{name:"remove_formatting",action:"removeAllFormatting",icon:ve}],[{name:"h1",action:"changeFormat",format:"h1",removeAction:"changeFormat",icon:Ce},{name:"h2",action:"changeFormat",format:"h2",removeAction:"changeFormat",icon:Se},{name:"h3",action:"changeFormat",format:"h3",removeAction:"changeFormat",icon:ge},{name:"ul",action:"makeUnorderedList",format:"ul",removeAction:"removeList",icon:Ne},{name:"ol",action:"makeOrderedList",format:"ol",removeAction:"removeList",icon:_e},{name:"quote",action:"increaseQuoteLevel",format:"blockquote",removeAction:"removeQuote",icon:xe},{name:"image",action:"insertImage",prompt:!0,icon:be}],[{name:"undo",action:"undo",icon:Te},{name:"redo",action:"redo",icon:we},{name:"html",customAction:"html",icon:Le}]],l=this.dataset.buttons?this.dataset.buttons.split(","):[],c=(d,h=i)=>{if(l.length&&!l.includes(d.name))return;let f=F("button");f.type="button",f.innerHTML=d.icon,f.dataset.action=d.customAction||d.action,f.dataset.removeAction=d.removeAction||"",f.dataset.format=d.format||"",f.dataset.prompt=d.prompt||"",f.ariaLabel=d.name,h.appendChild(f),this.buttons.push({el:f,btn:d})};a.forEach(d=>{if(Array.isArray(d)){let h=F("div");h.classList.add("squire-toolbar-group"),i.appendChild(h),d.forEach(f=>c(f,h))}else c(d)})}e=F("div"),e.classList.add("squire-input"),Et()&&e.classList.add("form-control"),this.appendChild(e);let n=this.el;Ae(e,i,n),this.config=Object.assign({blockTag:"div",blockAttributes:{class:"paragraph"},tagAttributes:{blockquote:{class:"blockquote"}},sanitizeToDOMFragment:(a,l)=>{let c=F("div");kt(c,a,ke);let d=le(c.innerHTML);return d?document.importNode(d,!0):document.createDocumentFragment()}},this.config);let o=this.dataset.allowPaste,r=this.dataset.pasteSize||1920;this.squire=new ee(e,this.config),this.squire.setHTML(n.value),this.squire.addEventListener("input",()=>{let a=this.squire.getHTML();this.el.value=a}),this.squire.addEventListener("cursor",()=>{let a=this.squire.getCursorPosition();if(!a)return;let l=e.getBoundingClientRect().top,c=a.top-l,d=a.bottom-l,h=0,f=0,u=e.offsetHeight,p=16;c<f+p?h=c-f-p:d>u-p&&(h=d+p-u),h&&e.scrollBy(0,Math.round(h)),this.buttons.forEach(C=>{Li(C.btn,C.el,this.squire)})}),o&&this.squire.addEventListener("pasteImage",a=>{let c=[...a.detail.clipboardData.items].filter(h=>/image/.test(h.type));if(!c.length)return!1;let d=new FileReader;d.onload=h=>{let f=""+h.target.result,u=this.squire;var p=new Image;p.src=f,p.onload=function(){if(this.width>r||this.height>r){alert(`Your images need to be less than ${r} pixels in height and width.`);return}u.insertImage(f)}},d.readAsDataURL(c[0].getAsFile())})}connected(){this.addEventListener("click",this),this.addEventListener("input",this),Ee.observe(this)}disconnected(){this.removeEventListener("click",this),this.removeEventListener("input",this),Ee.unobserve(this)}destroyed(){this.squire.destroy(),this.squire=null,this.buttons=null}$input(i){let e=this.el;i.target===e&&!e.dataset.fixedHeight&&(e.style.height="0",e.style.height=e.scrollHeight+"px")}$click(i){let e=i.target.closest("button");if(!e)return;let s=this.squire,n=e.dataset.action,o=e.dataset.removeAction,r=e.dataset.format,a=e.dataset.prompt,l,c,d=M("div",".squire-input",this);if(n==="html"){let h=M("textarea",null,this);if(h.hasAttribute("hidden")){if(!h.dataset.fixedHeight){let f=Math.max(parseInt(window.getComputedStyle(d).height),h.scrollHeight);h.style.height=f+"px"}d.setAttribute("hidden",""),h.removeAttribute("hidden"),this.buttons.forEach(f=>{f.btn.action&&(f.el.setAttribute("disabled","disabled"),f.el.classList.remove("is-active"))})}else this.squire.setHTML(h.value),h.setAttribute("hidden",""),d.removeAttribute("hidden"),this.buttons.forEach(f=>{f.btn.action&&f.el.removeAttribute("disabled")});return}if(n&&s&&s[n]){if(d.hasAttribute("hidden"))return;let h=s.getSelection();if(r&&o&&s.hasFormat(r))o==="changeFormat"&&(l=null,c={tag:r}),s[o](l,c);else{if(a){if(h.collapsed&&r)return;if(l=window.prompt(),!l){s[o](l,c);return}}n==="changeFormat"&&(l={tag:r}),s[n](l,c)}}}},yt=At;var ye=customElements,Oe=(t,i)=>{ye.get(t)||ye.define(t,i)};var Be=".squire-editor{position:relative;display:block}.squire-editor *{box-sizing:border-box}.squire-editor textarea{font-family:ui-monospace,'Cascadia Code','Source Code Pro',Menlo,Consolas,'DejaVu Sans Mono',monospace;width:100%;overflow:hidden}.squire-editor .squire-toolbar{position:absolute;background:var(--bs-tertiary-bg,#efefef);overflow:hidden}.squire-editor .squire-toolbar-group{border-right:1px solid rgba(100,100,100,.2);display:inline-block}.squire-editor .squire-toolbar-group:last-child{border-right:0}.squire-editor .squire-toolbar button{border:0;height:38px;width:38px;background:0 0}.squire-editor .squire-toolbar button.is-active,.squire-editor .squire-toolbar button:hover{background:rgba(100,100,100,.2)}";var De=(t,i)=>{if(!document.head.querySelector(`#${t}-style`)){let e=document.createElement("style");e.id=`${t}-style`,e.innerText=i,document.head.append(e)}};De("squire-editor",Be);Oe("squire-editor",yt);var ds=yt;})();
